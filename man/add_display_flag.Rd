% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_display_flag.R
\name{add_display_flag}
\alias{add_display_flag}
\title{Generic Flagging Function for Variable Display}
\usage{
add_display_flag(
  df,
  flag_col,
  admin_to_include = NULL,
  exclude_types = c("metadata", "administrative", "auth data", "embedded data",
    "embedded data from panel", "module"),
  exclude_empty_presentation = FALSE,
  overwrite = FALSE
)
}
\arguments{
\item{df}{The varinfo data frame.}

\item{flag_col}{String. The name of the column to create or update.}

\item{admin_to_include}{Optional vector of admin IDs to include
(e.g., c("2024", "2025")). If provided, variables must appear in at least
one of these admins (admin_id present in \code{AllSurveyAdmin}) to be flagged
as TRUE.}

\item{exclude_types}{Character vector of \code{ITEM_TYPE} values to flag as FALSE.}

\item{exclude_empty_presentation}{Logical. If TRUE, flags rows with empty or
NA \code{ITEM_PRESENTATION_TYPE} as FALSE.}

\item{overwrite}{Logical. If TRUE, ignores existing values in \code{flag_col}.}
}
\value{
A data frame with the updated flag column.
}
\description{
A flexible function to create boolean flag columns (e.g., DASH_DISPLAY,
CATALOG_DISPLAY) based on variable item types, administration years, and
presentation types.
}
\examples{
# 1. Create a sample varinfo table
varinfo_df <- data.frame(
  ITEM_NAME = c("AGE", "GENDER", "COMMENT", "DEPT_CODE", "MANUAL_HIDE"),
  ITEM_TYPE = c("Question", "Question", "Open Text", "administrative", "Question"),
  ITEM_PRESENTATION_TYPE = c("Bar", "Pie", NA, NA, "Bar"),
  AllSurveyAdmin = c("2024, 2025", "2025", "2025", "2025", "2025"),
  DASH_DISPLAY = c(NA, NA, NA, NA, FALSE), # Manual override already exists
  stringsAsFactors = FALSE
)

# 2. Strict Dashboard Flagging:
# Exclude administrative types, Open Text, and items without a chart type.
# Do NOT overwrite the manual 'FALSE' for MANUAL_HIDE.
dash_df <- add_display_flag(
  varinfo_df,
  flag_col = "DASH_DISPLAY",
  admin_to_include = c("2024", "2025"),
  exclude_types = c("administrative", "Open Text", "metadata"),
  exclude_empty_presentation = TRUE,
  overwrite = FALSE
)

# 3. Broad Catalog Flagging:
# Include Open Text, but exclude administrative.
# Ignore presentation type (NAs are OK).
catalog_df <- add_display_flag(
  varinfo_df,
  flag_col = "CATALOG_DISPLAY",
  admin_to_include = c("2025"),
  exclude_types = c("administrative", "metadata"),
  exclude_empty_presentation = FALSE,
  overwrite = TRUE
)
}
\seealso{
Other varinfo prep functions: 
\code{\link{add_catalog_display_flag}()},
\code{\link{add_dash_display_flag}()},
\code{\link{add_label_metadata}()},
\code{\link{check_and_export_unmatched}()},
\code{\link{get_catalog_varinfo}()},
\code{\link{get_dashboard_varinfo}()},
\code{\link{join_varinfo}()},
\code{\link{load_survey_column_info}()},
\code{\link{sort_varinfo}()},
\code{\link{sync_column_schema}()},
\code{\link{update_survey_admin_summaries}()}
}
\concept{varinfo prep functions}
